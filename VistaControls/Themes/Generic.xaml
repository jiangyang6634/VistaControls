<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:VistaControls"
    xmlns:converters="clr-namespace:VistaControls.Converters">
    
    <!-- 转换器资源 -->
    <converters:IconPathConverter x:Key="IconPathConverter"/>
    <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
    <converters:BoolToCornerRadiusConverter x:Key="BoolToCornerRadiusConverter"/>
    <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    <converters:MessageTypeToColorConverter x:Key="MessageTypeToColorConverter"/>
    <converters:BoolToHorizontalAlignmentConverter x:Key="BoolToHorizontalAlignmentConverter"/>
    <converters:WordLimitConverter x:Key="WordLimitConverter"/>
    <converters:StringToPlaceholderVisibilityConverter x:Key="StringToPlaceholderVisibilityConverter"/>
    <converters:SliderProgressConverter x:Key="SliderProgressConverter"/>
    <converters:SliderStopPositionConverter x:Key="SliderStopPositionConverter"/>
    <converters:RowClassToBackgroundConverter x:Key="RowClassToBackgroundConverter"/>
    <converters:TagTypeToBackgroundConverter x:Key="TagTypeToBackgroundConverter"/>
    <converters:TagTypeToTextColorConverter x:Key="TagTypeToTextColorConverter"/>
    <converters:TagTypeToBorderColorConverter x:Key="TagTypeToBorderColorConverter"/>
    <converters:TagBackgroundConverter x:Key="TagBackgroundConverter"/>
    <converters:TagBorderColorConverter x:Key="TagBorderColorConverter"/>
    <converters:TagTextColorConverter x:Key="TagTextColorConverter"/>
    <converters:ProgressWidthConverter x:Key="ProgressWidthConverter"/>
    <converters:ProgressCornerRadiusConverter x:Key="ProgressCornerRadiusConverter"/>
    <converters:LayoutContainsConverter x:Key="LayoutContainsConverter"/>
    <converters:BadgeTypeToBackgroundConverter x:Key="BadgeTypeToBackgroundConverter"/>
    
    <!-- 阴影效果 -->
    <DropShadowEffect x:Key="MessageShadow" 
                      Color="#000000" 
                      BlurRadius="10" 
                      ShadowDepth="2" 
                      Opacity="0.1"/>
    
    <!-- 颜色资源 -->
    <SolidColorBrush x:Key="PrimaryColor" Color="#409EFF"/>
    <SolidColorBrush x:Key="SuccessColor" Color="#67C23A"/>
    <SolidColorBrush x:Key="InfoColor" Color="#909399"/>
    <SolidColorBrush x:Key="WarningColor" Color="#E6A23C"/>
    <SolidColorBrush x:Key="DangerColor" Color="#F56C6C"/>
    <SolidColorBrush x:Key="DefaultBorderColor" Color="#DCDFE6"/>
    <SolidColorBrush x:Key="DefaultTextColor" Color="#606266"/>
    <SolidColorBrush x:Key="DisabledTextColor" Color="#C0C4CC"/>
    <SolidColorBrush x:Key="DisabledBorderColor" Color="#E4E7ED"/>
    <SolidColorBrush x:Key="DisabledBackgroundColor" Color="#FFFFFF"/>
    
    <!-- VistaButton 基础样式 -->
    <Style TargetType="{x:Type local:VistaButton}">
        <Setter Property="Padding" Value="28,18"/>
        <Setter Property="FontSize" Value="15"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="MinHeight" Value="28"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaButton}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Round, Converter={StaticResource BoolToCornerRadiusConverter}, ConverterParameter=20}"
                            Padding="{TemplateBinding Padding}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Loading 指示器 -->
                            <Ellipse x:Name="loadingIndicator" 
                                     Grid.Column="0"
                                     Width="16" Height="16"
                                     Visibility="Collapsed"
                                     Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Foreground}"
                                     StrokeThickness="2"
                                     Margin="0,0,10,0">
                                <Ellipse.RenderTransform>
                                    <RotateTransform x:Name="loadingRotate"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                            
                            <!-- 图标（左侧） -->
                            <Image x:Name="leftIcon"
                                   Grid.Column="0"
                                   Width="16" Height="16"
                                   Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IconSource, Converter={StaticResource NullToVisibilityConverter}}"
                                   Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IconSource}"
                                   Margin="0,0,10,0"
                                   Stretch="Uniform"/>
                            
                            <!-- 内容 -->
                            <ContentPresenter x:Name="contentPresenter"
                                              Grid.Column="1"
                                              Content="{TemplateBinding Content}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            
                            <!-- 图标（右侧） -->
                            <Image x:Name="rightIcon"
                                   Grid.Column="2"
                                   Width="16" Height="16"
                                   Visibility="Collapsed"
                                   Margin="10,0,0,0"
                                   Stretch="Uniform"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- Loading 状态 -->
                        <Trigger Property="Loading" Value="True">
                            <Setter TargetName="loadingIndicator" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="leftIcon" Property="Visibility" Value="Collapsed"/>
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimation Storyboard.TargetName="loadingRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         From="0" To="360" Duration="0:0:1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                        </Trigger>
                        
                        
                        <!-- Disabled 状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        
                        <!-- MouseOver 状态 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                        </Trigger>
                        
                        <!-- Pressed 状态 -->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- Circle 按钮 -->
            <Trigger Property="Circle" Value="True">
                <Setter Property="Width" Value="{Binding Height, RelativeSource={RelativeSource Self}}"/>
                <Setter Property="Padding" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:VistaButton}">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="50"
                                    Width="{TemplateBinding Height}">
                                <Grid>
                                    <Image x:Name="iconImage"
                                           Width="16" Height="16"
                                           Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IconSource, Converter={StaticResource NullToVisibilityConverter}}"
                                           Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IconSource}"/>
                                    <Ellipse x:Name="loadingIndicator" 
                                             Width="14" Height="14"
                                             Visibility="Collapsed"
                                             Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Foreground}"
                                             StrokeThickness="2">
                                        <Ellipse.RenderTransform>
                                            <RotateTransform x:Name="loadingRotate"/>
                                        </Ellipse.RenderTransform>
                                    </Ellipse>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Loading" Value="True">
                                    <Setter TargetName="loadingIndicator" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="iconImage" Property="Visibility" Value="Collapsed"/>
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetName="loadingRotate"
                                                                 Storyboard.TargetProperty="Angle"
                                                                 From="0" To="360" Duration="0:0:1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" Value="0.6"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
            
            <!-- 按钮类型样式 -->
            <Trigger Property="ButtonType" Value="Default">
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <ColorAnimation Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                           To="#C6E2FF" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Primary">
                <Setter Property="Background" Value="{StaticResource PrimaryColor}"/>
                <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Success">
                <Setter Property="Background" Value="{StaticResource SuccessColor}"/>
                <Setter Property="BorderBrush" Value="{StaticResource SuccessColor}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Info">
                <Setter Property="Background" Value="{StaticResource InfoColor}"/>
                <Setter Property="BorderBrush" Value="{StaticResource InfoColor}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Warning">
                <Setter Property="Background" Value="{StaticResource WarningColor}"/>
                <Setter Property="BorderBrush" Value="{StaticResource WarningColor}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Danger">
                <Setter Property="Background" Value="{StaticResource DangerColor}"/>
                <Setter Property="BorderBrush" Value="{StaticResource DangerColor}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
            
            <Trigger Property="ButtonType" Value="Text">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
            </Trigger>
            
            <!-- Plain 模式 -->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Plain" Value="True"/>
                    <Condition Property="ButtonType" Value="Primary"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Plain" Value="True"/>
                    <Condition Property="ButtonType" Value="Success"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource SuccessColor}"/>
                <Setter Property="Foreground" Value="{StaticResource SuccessColor}"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Plain" Value="True"/>
                    <Condition Property="ButtonType" Value="Info"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource InfoColor}"/>
                <Setter Property="Foreground" Value="{StaticResource InfoColor}"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Plain" Value="True"/>
                    <Condition Property="ButtonType" Value="Warning"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource WarningColor}"/>
                <Setter Property="Foreground" Value="{StaticResource WarningColor}"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Plain" Value="True"/>
                    <Condition Property="ButtonType" Value="Danger"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="{StaticResource DangerColor}"/>
                <Setter Property="Foreground" Value="{StaticResource DangerColor}"/>
            </MultiTrigger>
            
            <!-- 尺寸样式 -->
            <Trigger Property="ButtonSize" Value="Medium">
                <Setter Property="Padding" Value="36,14"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="MinHeight" Value="36"/>
            </Trigger>
            
            <Trigger Property="ButtonSize" Value="Small">
                <Setter Property="Padding" Value="30,10"/>
                <Setter Property="FontSize" Value="13"/>
                <Setter Property="MinHeight" Value="32"/>
            </Trigger>
            
            <Trigger Property="ButtonSize" Value="Mini">
                <Setter Property="Padding" Value="24,8"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="MinHeight" Value="28"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaTable 样式 -->
    <Style TargetType="{x:Type local:VistaTable}">
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTable}">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                        <Grid>
                            <ListView x:Name="PART_ListView"
                                      BorderThickness="0"
                                      AlternationCount="2147483647"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <ListView.Resources>
                                    <Style TargetType="GridViewColumnHeader">
                                        <Setter Property="Background" Value="#F5F7FA"/>
                                        <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                        <Setter Property="Padding" Value="14,18"/>
                                        <Setter Property="FontSize" Value="15"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        <Setter Property="SnapsToDevicePixels" Value="True"/>
                                    </Style>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="Padding" Value="14,18"/>
                                        <Setter Property="FontSize" Value="15"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        <Setter Property="SnapsToDevicePixels" Value="True"/>
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <MultiBinding Converter="{StaticResource RowClassToBackgroundConverter}">
                                                    <Binding RelativeSource="{RelativeSource Self}" Path="(ItemsControl.AlternationIndex)"/>
                                                    <Binding RelativeSource="{RelativeSource Self}" Path="Content"/>
                                                    <Binding RelativeSource="{RelativeSource AncestorType=local:VistaTable}"/>
                                                </MultiBinding>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListView.Resources>
                            </ListView>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ButtonGroup 样式 -->
    <Style TargetType="{x:Type local:ButtonGroup}">
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaMessage 样式 -->
    <Style TargetType="{x:Type local:VistaMessage}">
        <Setter Property="Background" Value="White"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="15,15"/>
        <Setter Property="MinWidth" Value="300"/>
        <Setter Property="MaxWidth" Value="500"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaMessage}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}"
                            Effect="{StaticResource MessageShadow}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 图标 -->
                            <Path x:Name="iconPath"
                                  Grid.Column="0"
                                  Width="16" Height="16"
                                  Margin="0,0,10,0"
                                  Stretch="Uniform"
                                  Data="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm.5 12H7V7h1.5v5zm0-6H7V4h1.5v2z"
                                  Fill="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MessageType, Converter={StaticResource MessageTypeToColorConverter}}"
                                  VerticalAlignment="Center"/>
                            
                            <!-- 消息内容 -->
                            <TextBlock x:Name="messageText"
                                       Grid.Column="1"
                                       Text="{TemplateBinding Message}"
                                       TextWrapping="Wrap"
                                       HorizontalAlignment="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Center, Converter={StaticResource BoolToHorizontalAlignmentConverter}}"
                                       VerticalAlignment="Center"
                                       Foreground="{StaticResource DefaultTextColor}"/>
                            
                            <!-- 关闭按钮 -->
                            <Button x:Name="closeButton"
                                    Grid.Column="2"
                                    Width="16" Height="16"
                                    Margin="10,0,0,0"
                                    Padding="0"
                                    BorderThickness="0"
                                    Background="Transparent"
                                    Cursor="Hand"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowClose, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Path Data="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3.5 10.5L8 8.5l-3.5 2L3.5 9.5 7 6l3.5-2L14 6l-3.5 3.5z"
                                      Fill="#C0C4CC"
                                      Stretch="Uniform"/>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="Transparent">
                                            <ContentPresenter/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 消息类型样式 -->
                        <Trigger Property="MessageType" Value="Success">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource SuccessColor}"/>
                            <Setter TargetName="iconPath" Property="Data" Value="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3.5 10.5L8 8.5l-3.5 2L3.5 9.5 7 6l3.5-2L14 6l-3.5 3.5z"/>
                            <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource SuccessColor}"/>
                        </Trigger>
                        
                        <Trigger Property="MessageType" Value="Warning">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource WarningColor}"/>
                            <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource WarningColor}"/>
                        </Trigger>
                        
                        <Trigger Property="MessageType" Value="Info">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource InfoColor}"/>
                            <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource InfoColor}"/>
                        </Trigger>
                        
                        <Trigger Property="MessageType" Value="Error">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource DangerColor}"/>
                            <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource DangerColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 消息类型样式 - 边框颜色 -->
            <Trigger Property="MessageType" Value="Success">
                <Setter Property="BorderBrush" Value="{StaticResource SuccessColor}"/>
            </Trigger>
            
            <Trigger Property="MessageType" Value="Warning">
                <Setter Property="BorderBrush" Value="{StaticResource WarningColor}"/>
            </Trigger>
            
            <Trigger Property="MessageType" Value="Info">
                <Setter Property="BorderBrush" Value="{StaticResource InfoColor}"/>
            </Trigger>
            
            <Trigger Property="MessageType" Value="Error">
                <Setter Property="BorderBrush" Value="{StaticResource DangerColor}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaRadio 基础样式 -->
    <Style TargetType="{x:Type local:VistaRadio}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaRadio}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            Padding="12,8"
                            MinHeight="32">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 单选框圆圈 -->
                            <Ellipse x:Name="radioCircle"
                                     Grid.Column="0"
                                     Width="14" Height="14"
                                     Margin="0,0,8,0"
                                     Stroke="{StaticResource DefaultBorderColor}"
                                     StrokeThickness="2"
                                     Fill="Transparent"
                                     VerticalAlignment="Center"/>
                            
                            <!-- 选中指示器 -->
                            <Ellipse x:Name="radioIndicator"
                                     Grid.Column="0"
                                     Width="8" Height="8"
                                     Margin="0,0,8,0"
                                     Fill="{StaticResource PrimaryColor}"
                                     Visibility="Collapsed"
                                     VerticalAlignment="Center"/>
                            
                            <!-- 内容 -->
                            <ContentPresenter x:Name="contentPresenter"
                                              Grid.Column="1"
                                              Content="{TemplateBinding Content}"
                                              VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 选中状态 -->
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="radioIndicator" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="radioCircle" Property="Stroke" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        
                        <!-- 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        
                        <!-- 鼠标悬停 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="radioCircle" Property="Stroke" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 带边框样式 -->
            <Trigger Property="Border" Value="True">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:VistaRadio}">
                            <Border x:Name="border"
                                    Background="White"
                                    BorderBrush="{StaticResource DefaultBorderColor}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    Padding="15,10"
                                    MinHeight="40">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- 单选框圆圈 -->
                                    <Ellipse x:Name="radioCircle"
                                             Grid.Column="0"
                                             Width="14" Height="14"
                                             Margin="0,0,10,0"
                                             Stroke="{StaticResource DefaultBorderColor}"
                                             StrokeThickness="2"
                                             Fill="Transparent"
                                             VerticalAlignment="Center"/>
                                    
                                    <!-- 选中指示器 -->
                                    <Ellipse x:Name="radioIndicator"
                                             Grid.Column="0"
                                             Width="8" Height="8"
                                             Margin="0,0,10,0"
                                             Fill="{StaticResource PrimaryColor}"
                                             Visibility="Collapsed"
                                             VerticalAlignment="Center"/>
                                    
                                    <!-- 内容 -->
                                    <ContentPresenter x:Name="contentPresenter"
                                                      Grid.Column="1"
                                                      Content="{TemplateBinding Content}"
                                                      VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!-- 选中状态 -->
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="radioIndicator" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="border" Property="Background" Value="#ECF5FF"/>
                                    <Setter TargetName="radioCircle" Property="Stroke" Value="{StaticResource PrimaryColor}"/>
                                </Trigger>
                                
                                <!-- 禁用状态 -->
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" Value="0.6"/>
                                </Trigger>
                                
                                <!-- 鼠标悬停 -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
            
            <!-- 尺寸样式 -->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="RadioSize" Value="Medium"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="15,10"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="RadioSize" Value="Small"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="RadioSize" Value="Mini"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </MultiTrigger>
        </Style.Triggers>
    </Style>

    <!-- RadioGroup 样式 -->
    <Style TargetType="{x:Type local:RadioGroup}">
    </Style>

    <!-- VistaCheckbox 基础样式 -->
    <Style TargetType="{x:Type local:VistaCheckbox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaCheckbox}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            Padding="12,8"
                            MinHeight="32">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 复选框方框 -->
                            <Border x:Name="checkboxBox"
                                    Grid.Column="0"
                                    Width="14" Height="14"
                                    Margin="0,0,8,0"
                                    BorderBrush="{StaticResource DefaultBorderColor}"
                                    BorderThickness="2"
                                    Background="Transparent"
                                    CornerRadius="2"
                                    VerticalAlignment="Center">
                                <!-- 选中指示器（对勾） -->
                                <Path x:Name="checkIndicator"
                                      Width="10" Height="10"
                                      Stretch="Uniform"
                                      Data="M4.5 8L2 5.5 1 6.5 4.5 10 13 1.5 12 0.5z"
                                      Fill="White"
                                      Visibility="Collapsed"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center"/>
                            </Border>
                            
                            <!-- Indeterminate 指示器（横线） -->
                            <Path x:Name="indeterminateIndicator"
                                  Grid.Column="0"
                                  Width="8" Height="2"
                                  Margin="0,0,8,0"
                                  Data="M0,1 L8,1"
                                  Stroke="White"
                                  StrokeThickness="2"
                                  Visibility="Collapsed"
                                  VerticalAlignment="Center"/>
                            
                            <!-- 内容 -->
                            <ContentPresenter x:Name="contentPresenter"
                                              Grid.Column="1"
                                              Content="{TemplateBinding Content}"
                                              VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 选中状态 -->
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="checkIndicator" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="checkboxBox" Property="Background" Value="{StaticResource PrimaryColor}"/>
                            <Setter TargetName="checkboxBox" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        
                        <!-- Indeterminate 状态 -->
                        <Trigger Property="IsChecked" Value="{x:Null}">
                            <Setter TargetName="indeterminateIndicator" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="checkboxBox" Property="Background" Value="{StaticResource PrimaryColor}"/>
                            <Setter TargetName="checkboxBox" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        
                        <!-- 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        
                        <!-- 鼠标悬停 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="checkboxBox" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 带边框样式 -->
            <Trigger Property="Border" Value="True">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:VistaCheckbox}">
                            <Border x:Name="border"
                                    Background="White"
                                    BorderBrush="{StaticResource DefaultBorderColor}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    Padding="15,10"
                                    MinHeight="40">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- 复选框方框 -->
                                    <Border x:Name="checkboxBox"
                                            Grid.Column="0"
                                            Width="14" Height="14"
                                            Margin="0,0,10,0"
                                            BorderBrush="{StaticResource DefaultBorderColor}"
                                            BorderThickness="2"
                                            Background="Transparent"
                                            CornerRadius="2"
                                            VerticalAlignment="Center">
                                        <!-- 选中指示器（对勾） -->
                                        <Path x:Name="checkIndicator"
                                              Width="10" Height="10"
                                              Stretch="Uniform"
                                              Data="M4.5 8L2 5.5 1 6.5 4.5 10 13 1.5 12 0.5z"
                                              Fill="White"
                                              Visibility="Collapsed"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"/>
                                    </Border>
                                    
                                    <!-- Indeterminate 指示器（横线） -->
                                    <Path x:Name="indeterminateIndicator"
                                          Grid.Column="0"
                                          Width="8" Height="2"
                                          Margin="0,0,10,0"
                                          Data="M0,1 L8,1"
                                          Stroke="White"
                                          StrokeThickness="2"
                                          Visibility="Collapsed"
                                          VerticalAlignment="Center"/>
                                    
                                    <!-- 内容 -->
                                    <ContentPresenter x:Name="contentPresenter"
                                                      Grid.Column="1"
                                                      Content="{TemplateBinding Content}"
                                                      VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!-- 选中状态 -->
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="checkIndicator" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="checkboxBox" Property="Background" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="checkboxBox" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="border" Property="Background" Value="#ECF5FF"/>
                                </Trigger>
                                
                                <!-- Indeterminate 状态 -->
                                <Trigger Property="IsChecked" Value="{x:Null}">
                                    <Setter TargetName="indeterminateIndicator" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="checkboxBox" Property="Background" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="checkboxBox" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                    <Setter TargetName="border" Property="Background" Value="#ECF5FF"/>
                                </Trigger>
                                
                                <!-- 禁用状态 -->
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" Value="0.6"/>
                                </Trigger>
                                
                                <!-- 鼠标悬停 -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
            
            <!-- 尺寸样式 -->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="CheckboxSize" Value="Medium"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="15,10"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="CheckboxSize" Value="Small"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </MultiTrigger>
            
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Border" Value="True"/>
                    <Condition Property="CheckboxSize" Value="Mini"/>
                </MultiTrigger.Conditions>
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </MultiTrigger>
        </Style.Triggers>
    </Style>

    <!-- CheckboxGroup 样式 -->
    <Style TargetType="{x:Type local:CheckboxGroup}">
    </Style>

    <!-- VistaInput 基础样式（缩短左侧内边距） -->
    <Style TargetType="{x:Type local:VistaInput}">
        <Setter Property="Padding" Value="2,6"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="MinHeight" Value="32"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaInput}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 输入框内容 -->
                            <Border Grid.Column="0" 
                                    Padding="{TemplateBinding Padding}"
                                    Background="Transparent">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost"
                                                  Focusable="False"
                                                  HorizontalScrollBarVisibility="Hidden"
                                                  VerticalScrollBarVisibility="Hidden"
                                                  CanContentScroll="False"/>
                                    <!-- 占位符文本 -->
                                    <TextBlock x:Name="placeholderText"
                                               Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Placeholder}"
                                               Foreground="#C0C4CC"
                                               VerticalAlignment="Center"
                                               IsHitTestVisible="False"
                                               Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Text, Converter={StaticResource StringToPlaceholderVisibilityConverter}}"/>
                                </Grid>
                            </Border>
                            
                            <!-- 右侧按钮容器 -->
                            <StackPanel x:Name="buttonContainer"
                                        Grid.Column="1"
                                        Orientation="Horizontal"
                                        VerticalAlignment="Center"
                                        Margin="0,0,8,0">
                                <!-- 字数统计 -->
                                <TextBlock x:Name="wordLimitText"
                                           Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowWordLimit, Converter={StaticResource BoolToVisibilityConverter}}"
                                           Foreground="{StaticResource DefaultTextColor}"
                                           FontSize="12"
                                           Margin="0,0,8,0"
                                           VerticalAlignment="Center">
                                    <TextBlock.Text>
                                        <MultiBinding Converter="{StaticResource WordLimitConverter}">
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Text"/>
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="MaxLength"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                                
                                <!-- 密码切换按钮 -->
                                <Button x:Name="PART_PasswordToggleButton"
                                        Width="20" Height="20"
                                        Padding="0"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        Cursor="Hand"
                                        Visibility="Collapsed">
                                    <Path x:Name="passwordIcon"
                                          Width="16" Height="16"
                                          Data="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm-1-9H7v2h2V5zm0 4H7v2h2V9z"
                                          Fill="#909399"
                                          Stretch="Uniform"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                
                                <!-- 清空按钮 -->
                                <Button x:Name="PART_ClearButton"
                                        Width="20" Height="20"
                                        Padding="0"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        Cursor="Hand"
                                        Visibility="Collapsed">
                                    <Path Width="16" Height="16"
                                          Data="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3.5 10.5L8 8.5l-3.5 2L3.5 9.5 7 6l3.5-2L14 6l-3.5 3.5z"
                                          Fill="#C0C4CC"
                                          Stretch="Uniform"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 焦点状态 -->
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        
                        <!-- 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="{StaticResource DisabledBackgroundColor}"/>
                            <Setter Property="Foreground" Value="{StaticResource DisabledTextColor}"/>
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        
                        <!-- 鼠标悬停 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 尺寸样式 -->
            <Trigger Property="InputSize" Value="Medium">
                <Setter Property="Padding" Value="2,8"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </Trigger>
            
            <Trigger Property="InputSize" Value="Small">
                <Setter Property="Padding" Value="2,6"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </Trigger>
            
            <Trigger Property="InputSize" Value="Mini">
                <Setter Property="Padding" Value="2,4"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </Trigger>
        </Style.Triggers>
    </Style>
    
    <!-- VistaCascader 样式 -->
    <Style TargetType="{x:Type local:VistaCascader}">
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaCascader}">
                    <Grid>
                        <Border x:Name="PART_Display"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <Grid Margin="{TemplateBinding Padding}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 文本/标签显示 -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <!-- 单选文本（完整路径或最后一级） -->
                                    <TextBlock x:Name="singlePathText"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource DefaultTextColor}"
                                               Visibility="Collapsed"/>

                                    <!-- 多选标签 -->
                                    <ItemsControl x:Name="multiTags" Visibility="Collapsed">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#F0F2F5" BorderBrush="#E4E7ED" BorderThickness="1" CornerRadius="3" Padding="6,2" Margin="0,0,6,0">
                                                    <TextBlock Text="{Binding}" Foreground="{StaticResource DefaultTextColor}"/>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <!-- 折叠文本 -->
                                    <TextBlock x:Name="multiCollapsedText"
                                               Visibility="Collapsed"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource DefaultTextColor}"/>

                                    <!-- 占位符 -->
                                    <TextBlock x:Name="placeholderText"
                                               Text="{TemplateBinding Placeholder}"
                                               Foreground="#C0C4CC"
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <!-- 清空按钮 -->
                                <Button x:Name="PART_Clear" Grid.Column="1" Width="18" Height="18" Margin="6,0,0,0" Padding="0" BorderThickness="0"
                                        Background="Transparent" Cursor="Hand" Visibility="Collapsed">
                                    <Path Width="12" Height="12" Data="M2 2 L10 10 M10 2 L2 10" Stroke="#C0C4CC" StrokeThickness="2"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- 箭头 -->
                                <Path Grid.Column="2" Width="10" Height="10" Margin="8,0,6,0" Stretch="Uniform"
                                      Data="M0 0 L5 5 L10 0" Stroke="#909399" StrokeThickness="2" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- 弹出多列菜单 -->
                        <Popup x:Name="PART_Popup"
                               Placement="Bottom"
                               StaysOpen="True"
                               AllowsTransparency="True"
                               PlacementTarget="{Binding ElementName=PART_Display}">
                            <Border Background="White" BorderBrush="{StaticResource DefaultBorderColor}" BorderThickness="1" CornerRadius="4" Padding="4">
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                                    <StackPanel Orientation="Horizontal">
                                        <ItemsControl ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Menus}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Horizontal"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <!-- 每一列 -->
                                                    <Border BorderBrush="{StaticResource DefaultBorderColor}" BorderThickness="0,0,1,0" Padding="0,0,8,0" Margin="0,0,8,0">
                                                        <ItemsControl ItemsSource="{Binding}">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                    <Border Padding="10,6" Background="Transparent">
                                                                        <TextBlock Text="{Binding Label}" Foreground="{StaticResource DefaultTextColor}"/>
                                                                    </Border>
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                        </ItemsControl>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaOption 样式 -->
    <Style TargetType="{x:Type local:VistaOption}">
        <Setter Property="Padding" Value="10,6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaOption}">
                    <Border x:Name="root" Background="Transparent" Padding="{TemplateBinding Padding}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="labelText" Text="{TemplateBinding Label}" Foreground="{StaticResource DefaultTextColor}" VerticalAlignment="Center"/>
                            <Path x:Name="check" Grid.Column="1" Width="12" Height="12" Margin="8,0,0,0"
                                  Data="M2 6 L5 9 L10 2" Stroke="{StaticResource PrimaryColor}" StrokeThickness="2" Visibility="Collapsed"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="root" Property="Background" Value="#F5F7FA"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        <!-- 自定义禁用状态（IsOptionDisabled） -->
                        <Trigger Property="local:VistaOption.IsOptionDisabled" Value="True">
                            <Setter TargetName="labelText" Property="Foreground" Value="{StaticResource DisabledTextColor}"/>
                            <Setter TargetName="root" Property="Background" Value="#FAFAFA"/>
                            <Setter Property="Opacity" Value="1"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaOptionGroup 样式 -->
    <Style TargetType="{x:Type local:VistaOptionGroup}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaOptionGroup}">
                    <StackPanel>
                        <TextBlock Text="{TemplateBinding Label}" Foreground="#909399" Margin="10,6,10,4"/>
                        <ItemsPresenter/>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaSelect 样式 -->
    <Style TargetType="{x:Type local:VistaSelect}">
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaSelect}">
                    <Grid>
                        <Border x:Name="PART_Display"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <Grid x:Name="contentGrid" Margin="{TemplateBinding Padding}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 占位符 / 已选内容 -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <!-- 多选标签（不折叠） -->
                                    <ItemsControl x:Name="tagList" Visibility="Collapsed">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#F0F2F5" BorderBrush="#E4E7ED" BorderThickness="1" CornerRadius="3" Padding="6,2" Margin="0,0,6,0">
                                                    <TextBlock Text="{Binding}" Foreground="{StaticResource DefaultTextColor}"/>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <!-- 折叠文本 -->
                                    <TextBlock x:Name="collapsedText" Visibility="Collapsed" Foreground="{StaticResource DefaultTextColor}" VerticalAlignment="Center"/>

                                    <!-- 单选文本 -->
                                    <TextBlock x:Name="singleText" Visibility="Collapsed" Foreground="{StaticResource DefaultTextColor}" VerticalAlignment="Center"/>

                                    <!-- 占位符 -->
                                    <TextBlock x:Name="placeholder" Text="{TemplateBinding Placeholder}" Foreground="#C0C4CC" VerticalAlignment="Center"/>
                                </StackPanel>

                                <!-- 清空按钮 -->
                                <Button x:Name="PART_Clear" Grid.Column="1" Width="18" Height="18" Margin="6,0,0,0" Padding="0" BorderThickness="0"
                                        Background="Transparent" Cursor="Hand" Visibility="Collapsed">
                                    <Path Width="12" Height="12" Data="M2 2 L10 10 M10 2 L2 10" Stroke="#C0C4CC" StrokeThickness="2"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- 箭头 -->
                                <Path Grid.Column="2" Width="10" Height="10" Margin="8,0,6,0" Stretch="Uniform"
                                      Data="M0 0 L5 5 L10 0" Stroke="#909399" StrokeThickness="2" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- 下拉 Popup -->
                        <Popup x:Name="PART_Popup" Placement="Bottom" StaysOpen="True" AllowsTransparency="True"
                               PlacementTarget="{Binding ElementName=PART_Display}">
                            <Border Background="White" BorderBrush="{StaticResource DefaultBorderColor}" BorderThickness="1" CornerRadius="4" Padding="4" SnapsToDevicePixels="True">
                                <ScrollViewer Height="240" VerticalScrollBarVisibility="Auto">
                                    <!-- 直接呈现 Items -->
                                    <ItemsPresenter/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        <!-- 自定义禁用状态（IsSelectDisabled） -->
                        <Trigger Property="local:VistaSelect.IsSelectDisabled" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource DisabledBorderColor}"/>
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaInputNumber 样式 -->
    <Style TargetType="{x:Type local:VistaInputNumber}">
        <Setter Property="Padding" Value="2,6"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="MinHeight" Value="32"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="TextAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaInputNumber}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition x:Name="colLeftBtn" Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition x:Name="colRightBtn" Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- 左侧减按钮（默认布局显示；当 ControlsPosition=right 时隐藏） -->
                            <Button x:Name="PART_Decrease"
                                    Grid.Column="0"
                                    Width="28" Height="28"
                                    Margin="4,2,0,2"
                                    Padding="0"
                                    BorderThickness="0"
                                    Background="Transparent"
                                    Cursor="Hand">
                                <Path Width="12" Height="12" Data="M0,5 L12,5 L12,7 L0,7 Z"
                                      Fill="{StaticResource DefaultTextColor}" Stretch="Uniform"/>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="Transparent">
                                            <ContentPresenter/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <!-- 输入框区域 -->
                            <Border Grid.Column="1" Padding="{TemplateBinding Padding}" Background="Transparent">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost"
                                                  Focusable="False"
                                                  HorizontalScrollBarVisibility="Hidden"
                                                  VerticalScrollBarVisibility="Hidden"
                                                  CanContentScroll="False"/>
                                    <!-- 占位符 -->
                                    <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Placeholder}"
                                               Foreground="#C0C4CC"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               IsHitTestVisible="False"
                                               Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Text, Converter={StaticResource StringToPlaceholderVisibilityConverter}}"/>
                                </Grid>
                            </Border>

                            <!-- 右侧加按钮 -->
                            <Button x:Name="PART_Increase"
                                    Grid.Column="2"
                                    Width="28" Height="28"
                                    Margin="0,2,4,2"
                                    Padding="0"
                                    BorderThickness="0"
                                    Background="Transparent"
                                    Cursor="Hand">
                                <Path Width="12" Height="12" Data="M0,5 L12,5 L12,7 L0,7 Z M5,0 L7,0 L7,12 L5,12 Z"
                                      Fill="{StaticResource DefaultTextColor}" Stretch="Uniform"/>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="Transparent">
                                            <ContentPresenter/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 焦点/悬停/禁用 -->
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>

                        <!-- 控制按钮显示或隐藏 -->
                        <Trigger Property="Controls" Value="False">
                            <Setter TargetName="PART_Decrease" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="PART_Increase" Property="Visibility" Value="Collapsed"/>
                        </Trigger>

                        <!-- 控制按钮位置：右侧 -->
                        <Trigger Property="ControlsPosition" Value="right">
                            <Setter TargetName="PART_Decrease" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 尺寸样式 -->
            <Trigger Property="NumberSize" Value="Medium">
                <Setter Property="Padding" Value="2,8"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </Trigger>
            <Trigger Property="NumberSize" Value="Small">
                <Setter Property="Padding" Value="2,6"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </Trigger>
            <Trigger Property="NumberSize" Value="Mini">
                <Setter Property="Padding" Value="2,4"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaSwitch 样式 -->
    <Style TargetType="{x:Type local:VistaSwitch}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaSwitch}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- 关闭状态文字（左侧） -->
                        <TextBlock x:Name="inactiveText"
                                   Grid.Column="0"
                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InactiveText}"
                                   Foreground="#909399"
                                   FontSize="14"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"
                                   Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InactiveText, Converter={StaticResource StringToVisibilityConverter}}"/>
                        
                        <!-- Switch 主体 -->
                        <Border x:Name="switchTrack"
                                Grid.Column="1"
                                Width="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Width}"
                                Height="20"
                                CornerRadius="10"
                                Background="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InactiveColor}"
                                VerticalAlignment="Center">
                            <Grid>
                                <!-- 滑块 -->
                                <Border x:Name="switchThumb"
                                        Width="16"
                                        Height="16"
                                        CornerRadius="8"
                                        Background="White"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Margin="2,0">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#000000" BlurRadius="4" ShadowDepth="0" Opacity="0.2"/>
                                    </Border.Effect>
                                    <Border.RenderTransform>
                                        <TranslateTransform x:Name="thumbTransform"/>
                                    </Border.RenderTransform>
                                </Border>
                            </Grid>
                        </Border>
                        
                        <!-- 打开状态文字（右侧） -->
                        <TextBlock x:Name="activeText"
                                   Grid.Column="2"
                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActiveText}"
                                   Foreground="#909399"
                                   FontSize="14"
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"
                                   Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActiveText, Converter={StaticResource StringToVisibilityConverter}}"/>
                    </Grid>
                    
                    <ControlTemplate.Triggers>
                        <!-- 打开状态 -->
                        <Trigger Property="IsChecked" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="thumbTransform"
                                                        Storyboard.TargetProperty="X"
                                                        To="20"
                                                        Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="thumbTransform"
                                                        Storyboard.TargetProperty="X"
                                                        To="0"
                                                        Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter TargetName="switchTrack" Property="Background" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActiveColor}"/>
                            <Setter TargetName="inactiveText" Property="Foreground" Value="#909399"/>
                            <Setter TargetName="activeText" Property="Foreground" Value="#409EFF"/>
                        </Trigger>
                        
                        <!-- 关闭状态 -->
                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="switchTrack" Property="Background" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InactiveColor}"/>
                            <Setter TargetName="inactiveText" Property="Foreground" Value="#409EFF"/>
                            <Setter TargetName="activeText" Property="Foreground" Value="#909399"/>
                        </Trigger>
                        
                        <!-- 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                            <Setter Property="Cursor" Value="Arrow"/>
                        </Trigger>
                        
                        <!-- 悬停效果 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="switchThumb"
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1.1"
                                                        Duration="0:0:0.1"/>
                                        <DoubleAnimation Storyboard.TargetName="switchThumb"
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1.1"
                                                        Duration="0:0:0.1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="switchThumb"
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1.0"
                                                        Duration="0:0:0.1"/>
                                        <DoubleAnimation Storyboard.TargetName="switchThumb"
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1.0"
                                                        Duration="0:0:0.1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Slider 按钮样式 -->
    <Style x:Key="SliderButtonStyle" TargetType="RepeatButton">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RepeatButton">
                    <Border Background="Transparent" 
                            Height="{TemplateBinding Height}" 
                            Width="{TemplateBinding Width}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!-- Slider 滑块样式 -->
    <Style x:Key="SliderThumbStyle" TargetType="Thumb">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="Height" Value="20"/>
        <Setter Property="Width" Value="20"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Thumb">
                    <Border Background="#409EFF" 
                            BorderBrush="#409EFF" 
                            BorderThickness="0"
                            CornerRadius="10"
                            Width="20" Height="20">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="4" ShadowDepth="0" Opacity="0.2"/>
                        </Border.Effect>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaSlider 样式 -->
    <Style TargetType="{x:Type local:VistaSlider}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaSlider}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- 主滑块区域 -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Slider 轨道和滑块 -->
                            <Grid Grid.Column="0" Margin="0,0,10,0" Height="24" VerticalAlignment="Center">
                                <!-- 轨道背景（灰色） -->
                                <Border x:Name="trackBackground"
                                        Background="#E4E7ED"
                                        Height="6"
                                        CornerRadius="3"
                                        VerticalAlignment="Center"/>
                                
                                <!-- 进度条（蓝色，已拖过的部分） -->
                                <Border x:Name="progressBar"
                                        Background="#409EFF"
                                        Height="6"
                                        CornerRadius="3"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Left">
                                    <Border.Width>
                                        <MultiBinding Converter="{StaticResource SliderProgressConverter}">
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Value"/>
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Minimum"/>
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Maximum"/>
                                            <Binding ElementName="trackBackground" Path="ActualWidth"/>
                                        </MultiBinding>
                                    </Border.Width>
                                </Border>
                                
                                <!-- Track 控件（用于交互） -->
                                <Track x:Name="PART_Track" 
                                       Focusable="False"
                                       IsDirectionReversed="{TemplateBinding IsDirectionReversed}">
                                    <Track.DecreaseRepeatButton>
                                        <RepeatButton Style="{StaticResource SliderButtonStyle}" 
                                                     Command="Slider.DecreaseLarge" />
                                    </Track.DecreaseRepeatButton>
                                    <Track.Thumb>
                                        <Thumb Style="{StaticResource SliderThumbStyle}"/>
                                    </Track.Thumb>
                                    <Track.IncreaseRepeatButton>
                                        <RepeatButton Style="{StaticResource SliderButtonStyle}" 
                                                     Command="Slider.IncreaseLarge" />
                                    </Track.IncreaseRepeatButton>
                                </Track>
                                
                                <!-- 间断点（白色） -->
                                <ItemsControl x:Name="PART_Stops" 
                                              Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowStops, Converter={StaticResource BoolToVisibilityConverter}}"
                                              IsHitTestVisible="False">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <Canvas/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemContainerStyle>
                                        <Style TargetType="ContentPresenter">
                                            <Setter Property="Canvas.Left">
                                                <Setter.Value>
                                                    <MultiBinding Converter="{StaticResource SliderStopPositionConverter}">
                                                        <Binding Path="Value"/>
                                                        <Binding RelativeSource="{RelativeSource AncestorType=local:VistaSlider}" Path="Minimum"/>
                                                        <Binding RelativeSource="{RelativeSource AncestorType=local:VistaSlider}" Path="Maximum"/>
                                                        <Binding ElementName="trackBackground" Path="ActualWidth"/>
                                                    </MultiBinding>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="Canvas.Top" Value="0"/>
                                        </Style>
                                    </ItemsControl.ItemContainerStyle>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Ellipse Width="6" Height="6" Fill="White" VerticalAlignment="Center" Margin="-3,0"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <!-- Tooltip -->
                                <Popup x:Name="PART_TooltipPopup" 
                                       Placement="Top" 
                                       AllowsTransparency="True"
                                       IsOpen="False"
                                       Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowTooltip, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <Border Background="#303133" 
                                            CornerRadius="4" 
                                            Padding="8,4"
                                            Margin="0,0,0,8">
                                        <TextBlock x:Name="PART_TooltipText" 
                                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Value, StringFormat='{}{0:F0}'}"
                                                   Foreground="White"
                                                   FontSize="12"/>
                                    </Border>
                                </Popup>
                                
                                <!-- 标记 -->
                                <ItemsControl x:Name="PART_Marks" 
                                              Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Marks, Converter={StaticResource NullToVisibilityConverter}}"
                                              IsHitTestVisible="False">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <Canvas/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </Grid>
                            
                            <!-- 输入框 -->
                            <local:VistaInputNumber x:Name="PART_InputNumber"
                                                    Grid.Column="1"
                                                    Width="130"
                                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowInput, Converter={StaticResource BoolToVisibilityConverter}}"
                                                    Controls="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowInputControls}"
                                                    NumberSize="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InputSize}"/>
                        </Grid>
                    </Grid>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6"/>
                        </Trigger>
                        
                        <Trigger Property="Orientation" Value="Vertical">
                            <Setter Property="LayoutTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="90"/>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaTimeSelect 样式 -->
    <Style TargetType="{x:Type local:VistaTimeSelect}">
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="MinHeight" Value="32"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTimeSelect}">
                    <Grid>
                        <Border x:Name="PART_Display"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Cursor="Hand">
                            <Grid Margin="{TemplateBinding Padding}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 显示文本 -->
                                <TextBlock x:Name="displayText"
                                           Grid.Column="0"
                                           Text="{TemplateBinding Value}"
                                           Foreground="{StaticResource DefaultTextColor}"
                                           VerticalAlignment="Center"
                                           Visibility="Collapsed"/>

                                <!-- 占位符 -->
                                <TextBlock x:Name="placeholder"
                                           Grid.Column="0"
                                           Text="{TemplateBinding Placeholder}"
                                           Foreground="#C0C4CC"
                                           VerticalAlignment="Center"
                                           Visibility="Visible"/>

                                <!-- 清空按钮 -->
                                <Button x:Name="PART_Clear" Grid.Column="1" Width="18" Height="18" Margin="6,0,0,0" Padding="0" BorderThickness="0"
                                        Background="Transparent" Cursor="Hand" Visibility="Collapsed">
                                    <Path Width="12" Height="12" Data="M2 2 L10 10 M10 2 L2 10" Stroke="#C0C4CC" StrokeThickness="2"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- 箭头 -->
                                <Path Grid.Column="2" Width="10" Height="10" Margin="8,0,6,0" Stretch="Uniform"
                                      Data="M0 0 L5 5 L10 0" Stroke="#909399" StrokeThickness="2" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- 下拉 Popup -->
                        <Popup x:Name="PART_Popup" Placement="Bottom" StaysOpen="True" AllowsTransparency="True"
                               PlacementTarget="{Binding ElementName=PART_Display}">
                            <Border Background="White" BorderThickness="0" CornerRadius="4" Padding="4" SnapsToDevicePixels="True">
                                <ScrollViewer x:Name="timeListScrollViewer" Height="240" VerticalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="timeListPanel" Orientation="Vertical"/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        <Trigger Property="IsDisabled" Value="True">
                            <Setter Property="Opacity" Value="0.6"/>
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                        <Trigger Property="Readonly" Value="True">
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 尺寸样式 -->
            <Trigger Property="InputSize" Value="Medium">
                <Setter Property="Padding" Value="8,8"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Small">
                <Setter Property="Padding" Value="8,6"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Mini">
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaTimePicker 样式 -->
    <Style TargetType="{x:Type local:VistaTimePicker}">
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="MinHeight" Value="32"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTimePicker}">
                    <Grid>
                        <Border x:Name="PART_Display"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Cursor="Hand">
                            <Grid Margin="{TemplateBinding Padding}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 单时间显示 -->
                                <TextBlock x:Name="displayText"
                                           Grid.Column="0"
                                           Foreground="{StaticResource DefaultTextColor}"
                                           VerticalAlignment="Center"
                                           Visibility="Collapsed"/>

                                <!-- 单时间占位符 -->
                                <TextBlock x:Name="placeholder"
                                           Grid.Column="0"
                                           Text="{TemplateBinding Placeholder}"
                                           Foreground="#C0C4CC"
                                           VerticalAlignment="Center"
                                           Visibility="Visible"/>

                                <!-- 范围模式显示 -->
                                <StackPanel x:Name="rangePanel" Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Visibility="Collapsed">
                                    <TextBlock x:Name="startDisplayText"
                                               Foreground="{StaticResource DefaultTextColor}"
                                               VerticalAlignment="Center"
                                               Visibility="Collapsed"/>
                                    <TextBlock x:Name="startPlaceholder"
                                               Text="{TemplateBinding StartPlaceholder}"
                                               Foreground="#C0C4CC"
                                               VerticalAlignment="Center"
                                               Visibility="Visible"/>
                                    <TextBlock x:Name="rangeSeparator"
                                               Text="至"
                                               Foreground="#C0C4CC"
                                               VerticalAlignment="Center"
                                               Margin="8,0"
                                               Visibility="Collapsed"/>
                                    <TextBlock x:Name="endDisplayText"
                                               Foreground="{StaticResource DefaultTextColor}"
                                               VerticalAlignment="Center"
                                               Visibility="Collapsed"/>
                                    <TextBlock x:Name="endPlaceholder"
                                               Text="{TemplateBinding EndPlaceholder}"
                                               Foreground="#C0C4CC"
                                               VerticalAlignment="Center"
                                               Visibility="Visible"/>
                                </StackPanel>

                                <!-- 清空按钮 -->
                                <Button x:Name="PART_Clear" Grid.Column="1" Width="18" Height="18" Margin="6,0,0,0" Padding="0" BorderThickness="0"
                                        Background="Transparent" Cursor="Hand" Visibility="Collapsed">
                                    <Path Width="12" Height="12" Data="M2 2 L10 10 M10 2 L2 10" Stroke="#C0C4CC" StrokeThickness="2"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- 箭头 -->
                                <Path Grid.Column="2" Width="10" Height="10" Margin="8,0,6,0" Stretch="Uniform"
                                      Data="M0 0 L5 5 L10 0" Stroke="#909399" StrokeThickness="2" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- 下拉 Popup -->
                        <Popup x:Name="PART_Popup" Placement="Bottom" StaysOpen="True" AllowsTransparency="True"
                               PlacementTarget="{Binding ElementName=PART_Display}">
                            <Border Background="White" BorderThickness="0" CornerRadius="4" Padding="8" SnapsToDevicePixels="True">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- 小时列 -->
                                    <ScrollViewer x:Name="hourScrollViewer" Grid.Column="0" Height="240" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                        <StackPanel x:Name="hourPanel" Orientation="Vertical"/>
                                    </ScrollViewer>

                                    <!-- 分钟列 -->
                                    <ScrollViewer x:Name="minuteScrollViewer" Grid.Column="1" Height="240" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                        <StackPanel x:Name="minutePanel" Orientation="Vertical"/>
                                    </ScrollViewer>

                                    <!-- 秒列 -->
                                    <ScrollViewer x:Name="secondScrollViewer" Grid.Column="2" Height="240" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                        <StackPanel x:Name="secondPanel" Orientation="Vertical"/>
                                    </ScrollViewer>
                                </Grid>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        <Trigger Property="IsDisabled" Value="True">
                            <Setter Property="Opacity" Value="0.6"/>
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                        <Trigger Property="Readonly" Value="True">
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 尺寸样式 -->
            <Trigger Property="InputSize" Value="Medium">
                <Setter Property="Padding" Value="8,8"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Small">
                <Setter Property="Padding" Value="8,6"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Mini">
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- TimeOptionButtonStyle - 时间选项按钮样式 -->
    <Style x:Key="TimeOptionButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#F5F7FA"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaDatePicker 样式 -->
    <Style TargetType="{x:Type local:VistaDatePicker}">
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="MinHeight" Value="32"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaDatePicker}">
                    <Grid>
                        <Border x:Name="PART_Display"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Cursor="Hand">
                            <Grid Margin="{TemplateBinding Padding}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 显示文本 -->
                                <TextBlock x:Name="displayText"
                                           Grid.Column="0"
                                           Foreground="{StaticResource DefaultTextColor}"
                                           VerticalAlignment="Center"
                                           Visibility="Collapsed"/>

                                <!-- 占位符 -->
                                <TextBlock x:Name="placeholder"
                                           Grid.Column="0"
                                           Text="{TemplateBinding Placeholder}"
                                           Foreground="#C0C4CC"
                                           VerticalAlignment="Center"
                                           Visibility="Visible"/>

                                <!-- 清空按钮 -->
                                <Button x:Name="PART_Clear" Grid.Column="1" Width="18" Height="18" Margin="6,0,0,0" Padding="0" BorderThickness="0"
                                        Background="Transparent" Cursor="Hand" Visibility="Collapsed">
                                    <Path Width="12" Height="12" Data="M2 2 L10 10 M10 2 L2 10" Stroke="#C0C4CC" StrokeThickness="2"/>
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="Transparent">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- 箭头 -->
                                <Path Grid.Column="2" Width="10" Height="10" Margin="8,0,6,0" Stretch="Uniform"
                                      Data="M0 0 L5 5 L10 0" Stroke="#909399" StrokeThickness="2" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <!-- 下拉 Popup -->
                        <Popup x:Name="PART_Popup" Placement="Bottom" StaysOpen="True" AllowsTransparency="True"
                               PlacementTarget="{Binding ElementName=PART_Display}">
                            <Border Background="White" BorderThickness="0" CornerRadius="4" Padding="8" SnapsToDevicePixels="True">
                                <Grid x:Name="calendarPanel">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- 快捷选项面板 -->
                                    <StackPanel x:Name="shortcutsPanel" Grid.Row="0" Orientation="Vertical" Margin="0,0,0,8" Visibility="Collapsed"/>

                                    <!-- 月份导航 -->
                                    <Grid Grid.Row="1" Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Button x:Name="prevMonthButton" Grid.Column="0" Width="24" Height="24" Padding="0" BorderThickness="0"
                                                Background="Transparent" Cursor="Hand">
                                            <Path Width="8" Height="8" Data="M5 0 L0 5 L5 10" Stroke="#606266" StrokeThickness="2"/>
                                        </Button>

                                        <TextBlock x:Name="monthYearText" Grid.Column="1" Text="2025年11月"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                   Foreground="{StaticResource DefaultTextColor}" FontSize="14"/>

                                        <Button x:Name="nextMonthButton" Grid.Column="2" Width="24" Height="24" Padding="0" BorderThickness="0"
                                                Background="Transparent" Cursor="Hand">
                                            <Path Width="8" Height="8" Data="M0 0 L5 5 L0 10" Stroke="#606266" StrokeThickness="2"/>
                                        </Button>
                                    </Grid>

                                    <!-- 星期标题 -->
                                    <UniformGrid x:Name="weekdayHeader" Grid.Row="2" Rows="1" Columns="7" Margin="0,0,0,4">
                                        <TextBlock Text="一" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="二" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="三" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="四" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="五" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="六" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                        <TextBlock Text="日" HorizontalAlignment="Center" Foreground="#909399" FontSize="12"/>
                                    </UniformGrid>

                                    <!-- 日期网格 -->
                                    <UniformGrid x:Name="dayGrid" Grid.Row="3" Rows="6" Columns="7" Margin="0,4,0,0"/>

                                    <!-- 月份网格 -->
                                    <StackPanel x:Name="monthGrid" Grid.Row="3" Orientation="Vertical" Margin="0,4,0,0" Visibility="Collapsed"/>

                                    <!-- 年份网格 -->
                                    <StackPanel x:Name="yearGrid" Grid.Row="3" Orientation="Vertical" Margin="0,4,0,0" Visibility="Collapsed"/>
                                </Grid>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Display" Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                        </Trigger>
                        <Trigger Property="IsDisabled" Value="True">
                            <Setter Property="Opacity" Value="0.6"/>
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                        <Trigger Property="Readonly" Value="True">
                            <Setter TargetName="PART_Display" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!-- 尺寸样式 -->
            <Trigger Property="InputSize" Value="Medium">
                <Setter Property="Padding" Value="8,8"/>
                <Setter Property="MinHeight" Value="36"/>
                <Setter Property="FontSize" Value="14"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Small">
                <Setter Property="Padding" Value="8,6"/>
                <Setter Property="MinHeight" Value="32"/>
                <Setter Property="FontSize" Value="13"/>
            </Trigger>
            <Trigger Property="InputSize" Value="Mini">
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="MinHeight" Value="28"/>
                <Setter Property="FontSize" Value="12"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- VistaTag 样式 -->
    <Style TargetType="{x:Type local:VistaTag}">
        <Setter Property="Padding" Value="10,0"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTag}">
                    <Border x:Name="border"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}">
                        <Border.Background>
                            <MultiBinding Converter="{StaticResource TagBackgroundConverter}">
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Color"/>
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="TagType"/>
                            </MultiBinding>
                        </Border.Background>
                        <Border.BorderBrush>
                            <MultiBinding Converter="{StaticResource TagBorderColorConverter}">
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Hit"/>
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="TagType"/>
                            </MultiBinding>
                        </Border.BorderBrush>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 内容 -->
                            <ContentPresenter x:Name="contentPresenter"
                                              Grid.Column="0"
                                              Content="{TemplateBinding Content}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                <ContentPresenter.ContentTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" 
                                                   Foreground="{Binding RelativeSource={RelativeSource AncestorType=local:VistaTag}, Path=TagType, Converter={StaticResource TagTypeToTextColorConverter}}"/>
                                    </DataTemplate>
                                </ContentPresenter.ContentTemplate>
                            </ContentPresenter>
                            
                            <!-- 关闭按钮 -->
                            <Button x:Name="PART_CloseButton"
                                    Grid.Column="1"
                                    Width="14" Height="14"
                                    Padding="0"
                                    BorderThickness="0"
                                    Background="Transparent"
                                    Cursor="Hand"
                                    Margin="4,0,0,0"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Closable, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Path Data="M7 0L4 3L1 0L0 1L3 4L0 7L1 8L4 5L7 8L8 7L5 4L8 1Z"
                                      Stretch="Uniform"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center"
                                      Fill="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TagType, Converter={StaticResource TagTypeToTextColorConverter}}">
                                    <Path.Style>
                                        <Style TargetType="Path">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextColor}" Value="{x:Null}">
                                                    <Setter Property="Fill" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TagType, Converter={StaticResource TagTypeToTextColorConverter}}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Path.Style>
                                </Path>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="Transparent">
                                            <ContentPresenter/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 鼠标悬停效果 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaProgress 样式 -->
    <Style TargetType="{x:Type local:VistaProgress}">
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaProgress}">
                    <Grid>
                        <!-- 线形进度条 -->
                        <Grid x:Name="lineProgress" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 进度条背景 -->
                            <Border x:Name="lineBackground"
                                    Grid.Row="0"
                                    MinHeight="6"
                                    Height="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth, FallbackValue=6}"
                                    HorizontalAlignment="Stretch"
                                    Background="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DefineBackColor, FallbackValue={StaticResource DefaultBorderColor}}"
                                    CornerRadius="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth, Converter={StaticResource ProgressCornerRadiusConverter}, FallbackValue=3}"
                                    Margin="0,0,0,10">
                                <!-- 进度条前景 -->
                                <Border x:Name="lineForeground"
                                        HorizontalAlignment="Left"
                                        MinHeight="6"
                                        Height="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth, FallbackValue=6}"
                                        Background="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ComputedColor, FallbackValue={StaticResource PrimaryColor}}"
                                        CornerRadius="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth, Converter={StaticResource ProgressCornerRadiusConverter}, FallbackValue=3}">
                                    <Border.Width>
                                        <MultiBinding>
                                            <MultiBinding.Converter>
                                                <converters:ProgressWidthConverter/>
                                            </MultiBinding.Converter>
                                            <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Percentage"/>
                                            <Binding RelativeSource="{RelativeSource AncestorType=Border}" Path="ActualWidth" FallbackValue="350"/>
                                        </MultiBinding>
                                    </Border.Width>
                                    
                                    <!-- 内部文字 -->
                                    <TextBlock x:Name="lineTextInside"
                                               Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FormattedText}"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Margin="10,0"
                                               FontSize="12"
                                               Foreground="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextColor, FallbackValue=White}"
                                               Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextInside, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                </Border>
                            </Border>
                            
                            <!-- 外部文字 -->
                            <TextBlock x:Name="lineTextOutside"
                                       Grid.Row="1"
                                       Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FormattedText}"
                                       FontSize="14"
                                       Foreground="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextColor, FallbackValue={StaticResource DefaultTextColor}}"
                                       Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextInside}" Value="False">
                                                <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                        
                        <!-- 环形/仪表盘进度条 -->
                        <Grid x:Name="circleProgress" Visibility="Collapsed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 进度条画布 -->
                            <Canvas x:Name="progressCanvas"
                                    Grid.Column="0"
                                    Width="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Width}"
                                    Height="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Width}">
                                <!-- 背景圆环 -->
                                <Path x:Name="progressBackground"
                                      Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DefineBackColor, FallbackValue={StaticResource DefaultBorderColor}}"
                                      StrokeThickness="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth}"
                                      StrokeStartLineCap="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeLinecap}"
                                      StrokeEndLineCap="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeLinecap}">
                                    <Path.Data>
                                        <PathGeometry>
                                            <PathFigure x:Name="backgroundFigure" StartPoint="0,0">
                                                <ArcSegment x:Name="backgroundArc" 
                                                           SweepDirection="Clockwise" 
                                                           IsLargeArc="False"/>
                                            </PathFigure>
                                        </PathGeometry>
                                    </Path.Data>
                                </Path>
                                
                                <!-- 前景圆环 -->
                                <Path x:Name="progressForeground"
                                      Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ComputedColor}"
                                      StrokeThickness="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeWidth}"
                                      StrokeStartLineCap="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeLinecap}"
                                      StrokeEndLineCap="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StrokeLinecap}">
                                    <Path.Data>
                                        <PathGeometry>
                                            <PathFigure x:Name="foregroundFigure" StartPoint="0,0">
                                                <ArcSegment x:Name="foregroundArc" 
                                                           SweepDirection="Clockwise" 
                                                           IsLargeArc="False"/>
                                            </PathFigure>
                                        </PathGeometry>
                                    </Path.Data>
                                </Path>
                                
                                <!-- 文字（显示在圆环内部） -->
                                <TextBlock x:Name="circleText"
                                           Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FormattedText}"
                                           FontSize="14"
                                           Foreground="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextColor, FallbackValue={StaticResource DefaultTextColor}}"
                                           Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </Canvas>
                            
                            <!-- 文字（显示在圆环右侧） -->
                            <TextBlock x:Name="circleTextRight"
                                       Grid.Column="1"
                                       Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FormattedText}"
                                       FontSize="14"
                                       Foreground="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TextColor, FallbackValue={StaticResource DefaultTextColor}}"
                                       VerticalAlignment="Center"
                                       Margin="10,0,0,0"
                                       Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ProgressType}" Value="Circle">
                                                <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ProgressType}" Value="Dashboard">
                                                <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShowText, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </Grid>
                    
                    <ControlTemplate.Triggers>
                        <!-- 根据类型显示不同的进度条 -->
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ProgressType}" Value="Circle">
                            <Setter TargetName="lineProgress" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="circleProgress" Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ProgressType}" Value="Dashboard">
                            <Setter TargetName="lineProgress" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="circleProgress" Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaPagination 样式 -->
    <Style TargetType="{x:Type local:VistaPagination}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaPagination}">
                    <Grid>
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=HideOnSinglePage}" Value="True"/>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TotalPages}" Value="1"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                            <!-- Prev Button -->
                            <Button x:Name="PART_PrevButton"
                                    Content="&lt;"
                                    Padding="8,0"
                                    Margin="0,0,4,0"
                                    FontSize="14"
                                    Cursor="Hand"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=prev}">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Width" Value="32"/>
                                        <Setter Property="Height" Value="32"/>
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                                        <Setter Property="BorderThickness" Value="1"/>
                                        <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="4">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=Small}" Value="True">
                                                <Setter Property="Width" Value="24"/>
                                                <Setter Property="Height" Value="28"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=HasBackground}" Value="True">
                                                <Setter Property="Background" Value="White"/>
                                            </DataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Foreground" Value="{StaticResource DisabledTextColor}"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource DisabledBorderColor}"/>
                                                <Setter Property="Background" Value="{StaticResource DisabledBackgroundColor}"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!-- Pager Buttons -->
                            <ItemsControl x:Name="PART_PagerContainer"
                                          ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=PagerButtons}"
                                          Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=pager}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type local:PagerButtonInfo}">
                                        <Button Content="{Binding Text}"
                                                Tag="{Binding Page}"
                                                Width="32"
                                                Height="32"
                                                Margin="0,0,4,0"
                                                FontSize="14"
                                                Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                                                    <Setter Property="BorderThickness" Value="1"/>
                                                    <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="4">
                                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <!-- 当 HasBackground="True" 时，默认背景色为白色 -->
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=HasBackground}" Value="True">
                                                            <Setter Property="Background" Value="White"/>
                                                        </DataTrigger>
                                                        <!-- 当 IsCurrent="True" 且 HasBackground="True" 时，背景色为黄色 -->
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding IsCurrent}" Value="True"/>
                                                                <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=HasBackground}" Value="True"/>
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="Background" Value="#FFFACD"/>
                                                            <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                                                            <Setter Property="BorderBrush" Value="#FFFACD"/>
                                                        </MultiDataTrigger>
                                                        <!-- 当 IsCurrent="True" 且 HasBackground="False" 时，使用默认的蓝色 -->
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding IsCurrent}" Value="True"/>
                                                                <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=HasBackground}" Value="False"/>
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="Background" Value="{StaticResource PrimaryColor}"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                            <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                                        </MultiDataTrigger>
                                                        <DataTrigger Binding="{Binding IsEllipsis}" Value="True">
                                                            <Setter Property="BorderThickness" Value="0"/>
                                                            <Setter Property="Cursor" Value="Arrow"/>
                                                        </DataTrigger>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
                                                            <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding IsEllipsis}" Value="True">
                                                            <Setter Property="IsEnabled" Value="False"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Next Button -->
                            <Button x:Name="PART_NextButton"
                                    Content="&gt;"
                                    Padding="8,0"
                                    Margin="0,0,4,0"
                                    FontSize="14"
                                    Cursor="Hand"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=next}">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Width" Value="32"/>
                                        <Setter Property="Height" Value="32"/>
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource DefaultBorderColor}"/>
                                        <Setter Property="BorderThickness" Value="1"/>
                                        <Setter Property="Foreground" Value="{StaticResource DefaultTextColor}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="4">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=Small}" Value="True">
                                                <Setter Property="Width" Value="24"/>
                                                <Setter Property="Height" Value="28"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=local:VistaPagination}, Path=HasBackground}" Value="True">
                                                <Setter Property="Background" Value="White"/>
                                            </DataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Foreground" Value="{StaticResource DisabledTextColor}"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource DisabledBorderColor}"/>
                                                <Setter Property="Background" Value="{StaticResource DisabledBackgroundColor}"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!-- Jumper -->
                            <StackPanel Orientation="Horizontal"
                                        Margin="8,0,0,0"
                                        Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=jumper}">
                                <TextBlock Text="前往" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource DefaultTextColor}"/>
                                <local:VistaInput x:Name="PART_JumperInput"
                                                  Width="50"
                                                  Height="32"
                                                  FontSize="14"
                                                  Padding="4,0"
                                                  VerticalContentAlignment="Center"/>
                                <TextBlock Text="页" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="{StaticResource DefaultTextColor}"/>
                            </StackPanel>

                            <!-- Sizes -->
                            <local:VistaSelect x:Name="PART_SizesSelect"
                                               Width="110"
                                               Height="32"
                                               Margin="8,0,0,0"
                                               Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=sizes}"/>

                            <!-- Total -->
                            <TextBlock x:Name="PART_TotalText"
                                       Text="共 0 条"
                                       VerticalAlignment="Center"
                                       Margin="8,0,0,0"
                                       Foreground="{StaticResource DefaultTextColor}"
                                       Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Layout, Converter={StaticResource LayoutContainsConverter}, ConverterParameter=total}"/>
                        </StackPanel>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaBadge 样式 -->
    <Style TargetType="{x:Type local:VistaBadge}">
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaBadge}">
                    <Grid>
                        <ContentPresenter x:Name="contentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"/>

                        <Border x:Name="badgeContainer"
                                Background="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Type, Converter={StaticResource BadgeTypeToBackgroundConverter}}"
                                BorderBrush="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Type, Converter={StaticResource BadgeTypeToBackgroundConverter}}"
                                CornerRadius="10"
                                Padding="6,0"
                                Height="20"
                                MinWidth="20"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Margin="0,-6,-6,0"
                                Visibility="Collapsed">
                            <TextBlock x:Name="badgeText"
                                       Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DisplayText}"
                                       Foreground="White"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       FontSize="12"
                                       FontWeight="Bold"
                                       Margin="2,0"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsBadgeVisible" Value="True">
                            <Setter TargetName="badgeContainer" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsDot" Value="True">
                            <Setter TargetName="badgeContainer" Property="Width" Value="8"/>
                            <Setter TargetName="badgeContainer" Property="Height" Value="8"/>
                            <Setter TargetName="badgeContainer" Property="MinWidth" Value="8"/>
                            <Setter TargetName="badgeContainer" Property="Padding" Value="0"/>
                            <Setter TargetName="badgeContainer" Property="CornerRadius" Value="4"/>
                            <Setter TargetName="badgeContainer" Property="Margin" Value="0,-4,-4,0"/>
                            <Setter TargetName="badgeText" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="IsDot" Value="False">
                            <Setter TargetName="badgeContainer" Property="CornerRadius" Value="10"/>
                            <Setter TargetName="badgeContainer" Property="Padding" Value="6,0"/>
                            <Setter TargetName="badgeContainer" Property="Height" Value="20"/>
                            <Setter TargetName="badgeContainer" Property="MinWidth" Value="20"/>
                            <Setter TargetName="badgeContainer" Property="Margin" Value="0,-6,-6,0"/>
                            <Setter TargetName="badgeText" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="badgeContainer" Property="Opacity" Value="0.6"/>
                        </Trigger>
                        <Trigger Property="Hidden" Value="True">
                            <Setter TargetName="badgeContainer" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="IsBadgeVisible" Value="False">
                            <Setter TargetName="badgeContainer" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="IsDot" Value="False">
                            <Setter TargetName="badgeText" Property="Foreground" Value="White"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaLoading 样式 -->
    <Style TargetType="{x:Type local:VistaLoading}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaLoading}">
                    <Grid>
                        <ContentPresenter x:Name="contentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"/>

                        <Border x:Name="PART_LoadingOverlay"
                                Background="{TemplateBinding BackgroundColor}"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Visibility="Collapsed"
                                IsHitTestVisible="{TemplateBinding Lock}">
                            <Border x:Name="PART_LoadingContent"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Background="Transparent">
                                <StackPanel Orientation="Vertical"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <Path x:Name="PART_Spinner"
                                          Data="M 50,50 A 40,40 0 1,1 50,10"
                                          Stroke="{StaticResource PrimaryColor}"
                                          StrokeThickness="4"
                                          StrokeStartLineCap="Round"
                                          StrokeEndLineCap="Round"
                                          Width="50"
                                          Height="50"
                                          HorizontalAlignment="Center"
                                          Margin="0,0,0,10">
                                        <Path.RenderTransform>
                                            <RotateTransform CenterX="25" CenterY="25"/>
                                        </Path.RenderTransform>
                                    </Path>
                                    <TextBlock x:Name="PART_LoadingText"
                                               Text="{TemplateBinding LoadingText}"
                                               FontSize="14"
                                               Foreground="{StaticResource PrimaryColor}"
                                               HorizontalAlignment="Center">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Visible"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LoadingText}" Value="">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LoadingText}" Value="{x:Null}">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsLoading" Value="True">
                            <Setter TargetName="PART_LoadingOverlay" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsLoading" Value="False">
                            <Setter TargetName="PART_LoadingOverlay" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaTabs 样式 -->
    <Style TargetType="{x:Type local:VistaTabs}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTabs}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- 标签头部区域 -->
                        <Border x:Name="PART_TabHeaderContainer"
                                Grid.Row="0"
                                Grid.Column="0"
                                Background="White"
                                BorderBrush="#DCDFE6"
                                BorderThickness="0,0,0,1">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ScrollViewer x:Name="HeaderScrollViewer"
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            HorizontalScrollBarVisibility="Auto"
                                            VerticalScrollBarVisibility="Disabled">
                                    <ItemsPresenter x:Name="ItemsPresenter"/>
                                </ScrollViewer>
                                <!-- 添加标签按钮 -->
                                <Button x:Name="PART_AddTabButton"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Content="+"
                                        Width="40"
                                        Height="40"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#409EFF"
                                        FontSize="20"
                                        FontWeight="Bold"
                                        Padding="0"
                                        Margin="10,0,0,0"
                                        Cursor="Hand"
                                        Visibility="Collapsed">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#F5F7FA"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- 内容区域 -->
                        <ContentControl x:Name="PART_TabContentContainer"
                                       Grid.Row="1"
                                       Grid.Column="0"
                                       HorizontalContentAlignment="Stretch"
                                       VerticalContentAlignment="Stretch"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="TabPosition" Value="Bottom">
                            <Setter TargetName="PART_TabHeaderContainer" Property="Grid.Row" Value="1"/>
                            <Setter TargetName="PART_TabContentContainer" Property="Grid.Row" Value="0"/>
                            <Setter TargetName="PART_TabHeaderContainer" Property="BorderThickness" Value="0,1,0,0"/>
                        </Trigger>
                        <Trigger Property="TabPosition" Value="Left">
                            <Setter TargetName="PART_TabHeaderContainer" Property="Grid.Row" Value="0"/>
                            <Setter TargetName="PART_TabHeaderContainer" Property="Grid.Column" Value="0"/>
                            <Setter TargetName="PART_TabContentContainer" Property="Grid.Row" Value="0"/>
                            <Setter TargetName="PART_TabContentContainer" Property="Grid.Column" Value="1"/>
                            <Setter TargetName="PART_TabHeaderContainer" Property="BorderThickness" Value="0,0,1,0"/>
                            <Setter TargetName="HeaderScrollViewer" Property="HorizontalScrollBarVisibility" Value="Disabled"/>
                            <Setter TargetName="HeaderScrollViewer" Property="VerticalScrollBarVisibility" Value="Auto"/>
                            <Setter TargetName="PART_AddTabButton" Property="Grid.Row" Value="1"/>
                            <Setter TargetName="PART_AddTabButton" Property="Grid.Column" Value="0"/>
                            <Setter TargetName="PART_AddTabButton" Property="Margin" Value="0,10,0,0"/>
                        </Trigger>
                        <Trigger Property="TabPosition" Value="Right">
                            <Setter TargetName="PART_TabHeaderContainer" Property="Grid.Row" Value="0"/>
                            <Setter TargetName="PART_TabHeaderContainer" Property="Grid.Column" Value="1"/>
                            <Setter TargetName="PART_TabContentContainer" Property="Grid.Row" Value="0"/>
                            <Setter TargetName="PART_TabContentContainer" Property="Grid.Column" Value="0"/>
                            <Setter TargetName="PART_TabHeaderContainer" Property="BorderThickness" Value="1,0,0,0"/>
                            <Setter TargetName="HeaderScrollViewer" Property="HorizontalScrollBarVisibility" Value="Disabled"/>
                            <Setter TargetName="HeaderScrollViewer" Property="VerticalScrollBarVisibility" Value="Auto"/>
                            <Setter TargetName="PART_AddTabButton" Property="Grid.Row" Value="1"/>
                            <Setter TargetName="PART_AddTabButton" Property="Grid.Column" Value="0"/>
                            <Setter TargetName="PART_AddTabButton" Property="Margin" Value="0,10,0,0"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VistaTabPane 样式 -->
    <Style TargetType="{x:Type local:VistaTabPane}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:VistaTabPane}">
                    <Grid>
                        <!-- 标签头部按钮（在 Tabs 的 ItemsPanel 中显示） -->
                        <Border x:Name="tabHeaderButton"
                                Background="Transparent"
                                BorderBrush="Transparent"
                                BorderThickness="0,0,0,2"
                                Padding="20,12"
                                Cursor="Hand"
                                MinWidth="80">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="tabLabel"
                                           Grid.Column="0"
                                           Text="{TemplateBinding Label}"
                                           FontSize="14"
                                           Foreground="#303133"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"/>
                                <Button x:Name="closeButton"
                                        Grid.Column="1"
                                        Content="✕"
                                        Width="16"
                                        Height="16"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#C0C4CC"
                                        FontSize="12"
                                        Padding="0"
                                        Margin="8,0,0,0"
                                        Cursor="Hand"
                                        Visibility="Collapsed">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="#409EFF"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="tabHeaderButton" Property="BorderBrush" Value="#409EFF"/>
                            <Setter TargetName="tabLabel" Property="Foreground" Value="#409EFF"/>
                        </Trigger>
                        <Trigger Property="IsTabDisabled" Value="True">
                            <Setter TargetName="tabLabel" Property="Foreground" Value="#C0C4CC"/>
                            <Setter TargetName="tabHeaderButton" Property="Cursor" Value="Arrow"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Closable" Value="True"/>
                                <Condition Property="IsSelected" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="closeButton" Property="Visibility" Value="Visible"/>
                        </MultiTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:VistaTabs}}, Path=Closable}" Value="True">
                            <Setter TargetName="closeButton" Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
